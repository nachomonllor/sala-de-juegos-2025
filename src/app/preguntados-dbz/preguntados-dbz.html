<section class="wrapper" *ngIf="!cargando(); else tplCargando">
  <ng-container *ngIf="pregunta() as p; else tplError">
    <header class="hud">
      <div><strong>Puntaje:</strong> {{ puntaje() }} / {{ totalPreguntas() }}</div>
      <button type="button" class="btn ghost" (click)="reiniciarPuntaje()">Reiniciar</button>
    </header>

    <div class="card">
      <h2>¿Quién es este personaje?</h2>

      <div class="image-box">
        <img [src]="p.imageUrl" [alt]="p.correct.name" loading="eager">
      </div>

      <div class="options">
        <button
          *ngFor="let opcion of p.options"
          type="button"
          class="btn option"
          [class.correct]="respondida() && opcion.id === p.correct.id"
          [class.wrong]="respondida() && opcion.id === idSeleccionado() && opcion.id !== p.correct.id"
          [disabled]="respondida()"
          (click)="elegir(opcion.id)">
          {{ opcion.name }}
        </button>
      </div>

      <div class="feedback" *ngIf="respondida()">
        <p *ngIf="esCorrecta(); else tplIncorrecta">✅ ¡Correcto! Era <strong>{{ p.correct.name }}</strong>.</p>
        <ng-template #tplIncorrecta>
          <p>❌ Incorrecto. La respuesta era <strong>{{ p.correct.name }}</strong>.</p>
        </ng-template>

        <button type="button" class="btn primary" (click)="siguientePregunta()">Siguiente</button>
      </div>
    </div>
  </ng-container>
</section>

<ng-template #tplCargando>
  <div class="loading">Cargando pregunta…</div>
</ng-template>

<ng-template #tplError>
  <div class="error">
    No fue posible cargar la pregunta. Intenta nuevamente.
    <button type="button" class="btn primary" (click)="siguientePregunta()">Reintentar</button>
  </div>
</ng-template>


<!-- <section class="wrapper" *ngIf="!loading(); else loadingTpl">
  <ng-container *ngIf="question() as q; else errorTpl">
    <header class="hud">
      <div><strong>Puntaje:</strong> {{ score() }} / {{ total() }}</div>
      <button type="button" class="btn ghost" (click)="resetScore()">Reiniciar</button>
    </header>

    <div class="card">
      <h2>¿Quién es este personaje?</h2>

      <div class="image-box">
        <img [src]="q.imageUrl" [alt]="q.correct.name" loading="eager">
      </div>

      <div class="options">
        <button
          *ngFor="let opt of q.options"
          type="button"
          class="btn option"
          [class.correct]="answered() && opt.id === q.correct.id"
          [class.wrong]="answered() && opt.id === selectedId() && opt.id !== q.correct.id"
          [disabled]="answered()"
          (click)="choose(opt.id)">
          {{ opt.name }}
        </button>
      </div>

      <div class="feedback" *ngIf="answered()">
        <p *ngIf="isCorrect(); else wrongTpl">✅ ¡Correcto! Era <strong>{{ q.correct.name }}</strong>.</p>
        <ng-template #wrongTpl>
          <p>❌ Incorrecto. La respuesta era <strong>{{ q.correct.name }}</strong>.</p>
        </ng-template>

        <button type="button" class="btn primary" (click)="nextQuestion()">Siguiente</button>
      </div>
    </div>
  </ng-container>
</section>

<ng-template #loadingTpl>
  <div class="loading">Cargando pregunta…</div>
</ng-template>

<ng-template #errorTpl>
  <div class="error">
    No fue posible cargar la pregunta. Intenta nuevamente.
    <button type="button" class="btn primary" (click)="nextQuestion()">Reintentar</button>
  </div>
</ng-template> -->

<!-- <div class="mt-3">
  <a routerLink="/home" class="btn btn-outline-primary">Volver al Home</a>
</div> -->
